# Create a new app

This section describes the steps to create a new app from scratch starting from an application generated by `create react app`.

The example create an app called `ethos-sample`

## Create a new app

Create a new app using Crate react app:

```js
npx create-react-app ethos-sample
```

Start the app

```js
npm start
```

## Step 0 - Cleanup and install the `core` module

First of all add the `core` module

```js
npm i @ethereansos/interfaces-core
```

and clean up the App.js file:

```js
<div className="App">Sample test</div>
```

## Step 1 - Context load and app initialization

Every app requires a `context` file that defines properties, contracts, etc.
This file is not part of the app and should be loaded dynamically at bootstrap time.

```json
// A sample of the context.json
{
  "ethereumNetwork": {
    "1": "",
    "3": "Ropsten"
  },
  "dappVersion": "BETA 0.3",
  "etherscanURL": "https://etherscan.io/",
  "etherscanURLRopsten": "https://ropsten.etherscan.io/",
  "uniSwapInfoURL": "https://uniswap.info/token/",
  "uniSwapSwapURLTemplate": "https://app.uniswap.org/#/swap?inputCurrency={0}&outputCurrency={1}",
  "penSwapSwapURLTemplate": "https://penguinswap.eth.link/#/swap?inputCurrency={0}&outputCurrency={1}",
  "uniSwapPoolURLTemplate": "https://app.uniswap.org/#/pool?inputCurrency={0}&outputCurrency={1}",
  ...
  "oneTimeProposalTemplate": [
    "contract DFOHubGeneratedProposal {",
    "",
    "    string private _metadataLink;",
    "",
    "    constructor(string memory metadataLink) {",
    "        _metadataLink = metadataLink;",
    "    }",
    "",
    "    function getMetadataLink() public view returns(string memory) {",
    "        return _metadataLink;",
    "    }",
    "",
    "    function callOneTime(address proposal) public {",
    "function_body",
    "    }",
    "}"
  ]
}
```

### InitContextProvider

To load and share in the app the `context` it's required to add to the app the `InitContextProvider`.

```js
import { InitContextProvider } from '@ethereansos/interfaces-core'

function App() {
  return (
    <InitContextProvider>
      <div className="App">Sample App</div>
    </InitContextProvider>
  )
}
```

The provider requires a `initMethod` props to do the initialization.
The props expect an async function that inject the `setReady` and the `setValue` method to allow the finalization of the `context` loading.

```js
<InitContextProvider
  initMethod={async ({ setReady, setValue }) => {
    try {
      // Fetch the context
      const response = await fetch(
        `${process.env.PUBLIC_URL}/data/context.json`
      )
      const context = await response.json()

      // Set the value of the context
      setValue('context', context)

      // Set the initialization ready
      setReady()
    } catch (e) {
      // Set the error
      setError('Context not loaded')
    }
  }}>
  <div className="App">Sample App</div>
</InitContextProvider>
```

Duting the application iniztialization the component shows the content of the `Loading` property and if it fails shows the `Error` property content.

```js
    <InitContextProvider
      initMethod={async ({ setReady, setValue }) => {
            // Fetch the context
           ...
      }}
      Loading={() => <div>Loading..</div>}
      Error={({ error }) => <div>Error..{error}</div>}
    >
      <div className="App">Sample App</div>
    </InitContextProvider>
```

### useEthosContext

The `context` is exposed to the app with the hook `useEthosContext`

Create a ContextViewer component

```js
const ContextViewer = () => {
  const context = useEthosContext()
  return <pre>{JSON.stringify(context, null, 2)}</pre>
}
```

Add the component to the app

```js
    <InitContextProvider
      initMethod={async ({ setReady, setValue }) => {
            // Fetch the context
           ...
      }}
      Loading={() => <div>Loading..</div>}
      Error={({ error }) => <div>Error..{error}</div>}
    >
      <div className="App">Sample App</div>
      <ContextViewer/>
    </InitContextProvider>
```

## Step 2 - Integrate the plugin system
